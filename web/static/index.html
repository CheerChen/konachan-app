<html>
<head>
    <meta charset="utf-8">
    <meta name="referrer" content="never"/>
    <title>Konachan-app</title>
    <link rel="stylesheet" href="/web/static/bootstrap.min.css">

    <!-- Import PhotoSwipe Styles -->
    <link rel="stylesheet" href="/web/static/photoswipe.css">
    <link rel="stylesheet" href="/web/static/default-skin/default-skin.css">

    <link rel="shortcut icon" href="/web/static/favicon.ico"/>
    <link rel="bookmark" href="/web/static/favicon.ico"/>
    <!-- A touch of fanciness üíÑ -->
    <link href='https://fonts.font.im/css?family=Bitter:400,700,400italic' rel='stylesheet' type='text/css'>
    <style>
        body {
            background: #222;
            font-family: 'Bitter', Georgia, Times, sans-serif;
        }

        h1 {
            margin: 2em;
        }

        .pswp__caption__center {
            text-align: center;
        }

        figure {
            flex: 25%;
            max-width: 25%;
            padding: 0 4px;
        }

        img {
            margin-top: 8px;
            vertical-align: middle;
            width: 100%;
        }

        .spacer {
            height: 5em;
        }

        .gallery {
            display: flex;
            flex-wrap: wrap;
            padding: 0 4px;
        }

        /* Responsive layout - makes a two column-layout instead of four columns */
        @media screen and (max-width: 800px) {
            .column {
                flex: 50%;
                max-width: 50%;
            }
        }

        /* Responsive layout - makes the two columns stack on top of each other instead of next to each other */
        @media screen and (max-width: 600px) {
            .column {
                flex: 100%;
                max-width: 100%;
            }
        }

        .next_page {
            font-size: 12px;
        }

        .page-limits {
            font-size: 12px;
        }

        .prev_page {
            font-size: 12px;
        }

    </style>
</head>
<body>
<div class="container">
    <div class="row">
        <div class="col-sm-12 col-sm-offset-0">

            <h1 class="text-center">
                Posts
                <a href="/album" title="To Album">
                    <img style="width: 16px; height: 16px"
                         src="data:image/png;base64,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"
                         alt="Album">
                </a>
                <br>
            </h1>
            <small>
                <select class="page-limits">
                    <option value="100">100p</option>
                    </option>
                    <option value="500">500p</option>
                </select>
                <a class="prev_page" rel="prev" href="javascript:;">‚Üê Prev</a>
                <a class="next_page" rel="next" href="javascript:;">Next ‚Üí</a>
            </small>

            <!-- Galley wrapper that contains all items -->
            <div id="gallery" class="gallery" itemscope itemtype="http://schema.org/ImageGallery">


            </div>

        </div>
    </div>
</div>

<!-- Some spacing üòâ -->
<div class="spacer"></div>


<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe.
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides.
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>

<!-- Import jQuery and PhotoSwipe Scripts -->
<script src="/web/static/jquery-2.1.1.min.js"></script>
<script src="/web/static/photoswipe.min.js"></script>
<script src="/web/static/photoswipe-ui-default.min.js"></script>

<script>
    'use strict';

    /* global jQuery, PhotoSwipe, PhotoSwipeUI_Default, console */


    (function ($) {

        var getUrlParameter = function getUrlParameter(sParam) {
            var sPageURL = window.location.search.substring(1),
                sURLVariables = sPageURL.split('&'),
                sParameterName,
                i;

            for (i = 0; i < sURLVariables.length; i++) {
                sParameterName = sURLVariables[i].split('=');

                if (sParameterName[0] === sParam) {
                    return sParameterName[1] === undefined ? true : decodeURIComponent(sParameterName[1]);
                }
            }
        };

        // Init empty gallery array
        var container = [];

        // Loop over gallery items and push it to the array
        // $('h1').click(function (event) {
        let page = 1;
        if (getUrlParameter("page") != null) {
            page = getUrlParameter("page")
        }
        let limit = 100;
        if (getUrlParameter("limit") != null) {
            limit = getUrlParameter("limit")
            $(".page-limits").val(limit)
        }
        let url = `/remote/${limit}/${page}/`;


        let tag = "";
        if (getUrlParameter("tag") != null) {
            tag = getUrlParameter("tag")
            url += tag;
            if (tag.length > 0) {
                $('h1').text(tag);
            }
        }

        function add2Tags(tag) {
            return `<a href="?page=1&tag=${encodeURIComponent(tag)}" target="_blank">${tag}</a>`;
        }

        $.getJSON(url, function (data) {
            $.each(data.data, function (i, item) {
                var ddaystrs = new Array();
                ddaystrs = item.tags.split(" ");

                let title = `<h4 class="all-copy">
<a href="https://konachan.com/post/show/${item.id}" target="_blank">${item.id}</a> - ${ddaystrs.map(add2Tags).join(" ")}
</h4><p>tfidf+ScoreÔºö${item.my_score} / tfidfÔºö${item.tf_idf} / ScoreÔºö${item.score} / ${item.width}x${item.height} /
<a href="/download/${item.id}" target="_blank">Download</a></p>`;
                if (item.is_fav) {
                    title += `<a href="/delete/${item.id}" target="_blank">Delete</a>`;
                }
                let slideItem = {
                    msrc: item.preview_url,
                    src: item.sample_url,
                    w: item.sample_width,
                    h: item.sample_height,
                    title: title
                };
                container.push(slideItem);
                let figureHtml = "";
                if (item.is_fav) {
                    figureHtml = `<figure itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject">
<a href="${slideItem.src}" data-caption="" data-width="${slideItem.w}" data-height="${slideItem.h}" itemprop="contentUrl">
<img src="${slideItem.msrc}" itemprop="thumbnail" alt="Image description" style="opacity:0.1"></a></figure>`
                } else {
                    figureHtml = `<figure itemprop="associatedMedia" itemscope itemtype="http://schema.org/ImageObject">
<a href="${slideItem.src}" data-caption="" data-width="${slideItem.w}" data-height="${slideItem.h}" itemprop="contentUrl">
<img src="${slideItem.msrc}" itemprop="thumbnail" alt="Image description"></a></figure>`
                }
                $("#gallery").append(figureHtml);
            });

            // Define click event on gallery item
            $('.gallery a').click(function (event) {

                // Prevent location change
                event.preventDefault();

                // Define object and gallery options
                var $pswp = $('.pswp')[0],
                    options = {
                        index: $(this).parent('figure').index(),
                        bgOpacity: 0.85,
                        showHideOpacity: true,
                        closeOnScroll: false,
                        shareButtons: [
                            {id: 'download', label: 'Download image', url: '{{raw_image_url}}', download: true}
                        ],

                    };

                // Initialize PhotoSwipe
                var gallery = new PhotoSwipe($pswp, PhotoSwipeUI_Default, container, options);
                gallery.init();
            });
        });
        $('.next_page').click(function (event) {
            let l = window.location.href.split('?')[0]
            let page = 1;
            if (getUrlParameter("page") != null) {
                page = parseInt(getUrlParameter("page"));
            }
            page++;

            let tag = "";
            if (getUrlParameter("tag") != null) {
                tag = getUrlParameter("tag");
            }

            let limit = $(".page-limits").val();

            window.location.href = l + `?page=${page}&limit=${limit}&tag=${tag}`;
        });

        $('.prev_page').click(function (event) {
            let l = window.location.href.split('?')[0]
            let page = 1;
            if (getUrlParameter("page") != null) {
                page = parseInt(getUrlParameter("page"));
            }
            if (page > 1) {
                page--
            }

            let limit = $(".page-limits").val();

            let tag = "";
            if (getUrlParameter("tag") != null) {
                tag = getUrlParameter("tag");
            }
            window.location.href = l + `?page=${page}&limit=${limit}&tag=${tag}`;
        });

        $(".page-limits").change(function () {
            let l = window.location.href.split('?')[0]
            let page = 1;
            if (getUrlParameter("page") != null) {
                page = parseInt(getUrlParameter("page"));
            }

            let limit = $(".page-limits").val();

            let tag = "";
            if (getUrlParameter("tag") != null) {
                tag = getUrlParameter("tag");
            }

            window.location.href = l + `?page=${page}&limit=${limit}&tag=${tag}`;
        });

    }(jQuery));
</script>
</body>
</html>